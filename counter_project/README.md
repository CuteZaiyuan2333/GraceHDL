# è®¡æ•°å™¨é¡¹ç›® (Counter Project)

è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†ä½¿ç”¨ GraceHDL è®¾è®¡çš„å‡ ä¸ªå®ç”¨æ•°å­—ç”µè·¯ï¼Œå¹¶æˆåŠŸç¼–è¯‘ä¸ºæ ‡å‡†çš„ Verilog HDL ä»£ç ã€‚

## é¡¹ç›®æ–‡ä»¶

### 1. advanced_counter.ghdl / advanced_counter.v
**é«˜çº§8ä½è®¡æ•°å™¨**
- **åŠŸèƒ½**: å¸¦æœ‰ä½¿èƒ½æ§åˆ¶å’Œä¸Šä¸‹è®¡æ•°åŠŸèƒ½çš„8ä½è®¡æ•°å™¨
- **è¾“å…¥**: 
  - `clk`: æ—¶é’Ÿä¿¡å·
  - `reset`: å¤ä½ä¿¡å·
  - `enable`: ä½¿èƒ½ä¿¡å·
  - `up_down`: è®¡æ•°æ–¹å‘æ§åˆ¶ï¼ˆ1=å‘ä¸Šï¼Œ0=å‘ä¸‹ï¼‰
- **è¾“å‡º**:
  - `count[7:0]`: 8ä½è®¡æ•°å€¼
  - `overflow`: ä¸Šæº¢æ ‡å¿—
  - `underflow`: ä¸‹æº¢æ ‡å¿—
- **ç‰¹æ€§**: 
  - åŒæ­¥å¤ä½
  - å¯æ§åˆ¶è®¡æ•°æ–¹å‘
  - æº¢å‡ºæ£€æµ‹

### 2. pwm_counter.ghdl / pwm_counter.v
**PWMè®¡æ•°å™¨**
- **åŠŸèƒ½**: ç”ŸæˆPWMä¿¡å·çš„è®¡æ•°å™¨
- **è¾“å…¥**:
  - `clk`: æ—¶é’Ÿä¿¡å·
  - `reset`: å¤ä½ä¿¡å·
  - `enable`: ä½¿èƒ½ä¿¡å·
- **è¾“å‡º**:
  - `count[7:0]`: å½“å‰è®¡æ•°å€¼
  - `pwm_out`: PWMè¾“å‡ºä¿¡å·
  - `period_complete`: å‘¨æœŸå®Œæˆæ ‡å¿—
- **ç‰¹æ€§**:
  - å›ºå®š50%å ç©ºæ¯”ï¼ˆduty_cycle = 128ï¼‰
  - 8ä½åˆ†è¾¨ç‡PWMè¾“å‡º

### 3. traffic_light.ghdl / traffic_light.v
**äº¤é€šç¯çŠ¶æ€æœº**
- **åŠŸèƒ½**: ç®€å•çš„ä¸‰çŠ¶æ€äº¤é€šç¯æ§åˆ¶å™¨
- **è¾“å…¥**:
  - `clk`: æ—¶é’Ÿä¿¡å·
  - `reset`: å¤ä½ä¿¡å·
  - `sensor`: ä¼ æ„Ÿå™¨è¾“å…¥ï¼ˆé¢„ç•™ï¼‰
- **è¾“å‡º**:
  - `red`: çº¢ç¯æ§åˆ¶
  - `yellow`: é»„ç¯æ§åˆ¶
  - `green`: ç»¿ç¯æ§åˆ¶
  - `state[1:0]`: å½“å‰çŠ¶æ€
- **çŠ¶æ€**:
  - çŠ¶æ€0: çº¢ç¯
  - çŠ¶æ€1: é»„ç¯
  - çŠ¶æ€2: ç»¿ç¯
- **ç‰¹æ€§**:
  - è‡ªåŠ¨çŠ¶æ€è½¬æ¢
  - å¯é…ç½®å®šæ—¶å™¨

## GraceHDL æ–°ç‰¹æ€§å±•ç¤º

è¿™äº›è®¾è®¡å±•ç¤ºäº† GraceHDL çš„ä»¥ä¸‹æ–°ç‰¹æ€§ï¼š

1. **æ–°æ•°å€¼æ ¼å¼**: `(value, base, width)`
   - `(0, d, 8)` â†’ `8'd0` (8ä½åè¿›åˆ¶)
   - `(255, d, 8)` â†’ `8'd255` (8ä½åè¿›åˆ¶)
   - `(1, b, 1)` â†’ `1'b1` (1ä½äºŒè¿›åˆ¶)

2. **ç®€æ´çš„æ¨¡å—å®šä¹‰è¯­æ³•**:
   ```ghdl
   module name:
       input(...)
       output(...)
       register(...)
   ```

3. **æ¸…æ™°çš„æ—¶åºå’Œç»„åˆé€»è¾‘åˆ†ç¦»**:
   - `run (clk.posedge):` ç”¨äºæ—¶åºé€»è¾‘
   - `always:` ç”¨äºç»„åˆé€»è¾‘

## ç¼–è¯‘ç»“æœ

æ‰€æœ‰ GraceHDL æ–‡ä»¶éƒ½æˆåŠŸç¼–è¯‘ä¸ºæ ‡å‡†çš„ Verilog HDL ä»£ç ï¼Œç”Ÿæˆçš„ä»£ç ï¼š
- è¯­æ³•æ­£ç¡®ï¼Œç¬¦åˆ Verilog æ ‡å‡†
- ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç†è§£
- å¯ä»¥ç›´æ¥ç”¨äº FPGA æˆ– ASIC è®¾è®¡æµç¨‹

### 4. simple_test.ghdl / simple_test.v
**ç®€å•è®¡æ•°å™¨æµ‹è¯•**
- **åŠŸèƒ½**: åŸºç¡€çš„8ä½è®¡æ•°å™¨å®ç°
- **ç‰¹æ€§**: æ¼”ç¤ºåŸºæœ¬çš„ GraceHDL è¯­æ³•ç»“æ„

### 5. state_machine_test.ghdl
**Caseè¯­å¥æµ‹è¯•**
- **åŠŸèƒ½**: æ¼”ç¤º case è¯­å¥çš„ä½¿ç”¨
- **ç‰¹æ€§**: ç®€å•çš„çŠ¶æ€é€‰æ‹©é€»è¾‘

## ç¼–è¯‘çŠ¶æ€

âœ… **æˆåŠŸç¼–è¯‘çš„æ–‡ä»¶**:
- `advanced_counter.ghdl` â†’ `advanced_counter.v`
- `pwm_counter.ghdl` â†’ `pwm_counter.v`  
- `traffic_light.ghdl` â†’ `traffic_light.v`
- `simple_test.ghdl` â†’ `simple_test.v`
- `counter_demo.ghdl` â†’ `counter_demo.v`

ğŸ”§ **æµ‹è¯•æ–‡ä»¶**:
- `state_machine_test.ghdl` - Caseè¯­å¥åŠŸèƒ½éªŒè¯

## ä½¿ç”¨æ–¹æ³•

ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘å™¨ï¼š
```bash
python gracehdl_compiler.py <input.ghdl> [-o output.v]
```

ä¾‹å¦‚ï¼š
```bash
python gracehdl_compiler.py counter_project\advanced_counter.ghdl -o advanced_counter.v
```

æˆ–ä½¿ç”¨æ¨¡å—æ¥å£ï¼š
```bash
python -m src.compiler <input.ghdl> <output.v>
```

## éªŒè¯ç»“æœ

æ‰€æœ‰ç”Ÿæˆçš„ Verilog ä»£ç éƒ½ç»è¿‡éªŒè¯ï¼š
- è¯­æ³•æ­£ç¡®ï¼Œç¬¦åˆ IEEE 1364 æ ‡å‡†
- é€»è¾‘åŠŸèƒ½ä¸è®¾è®¡æ„å›¾ä¸€è‡´
- å¯ä»¥åœ¨æ ‡å‡† Verilog ä»¿çœŸå™¨ä¸­è¿è¡Œ
- é€‚ç”¨äº FPGA ç»¼åˆå·¥å…·